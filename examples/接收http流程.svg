<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="458px" preserveAspectRatio="none" style="width:453px;height:458px;background:#FFFFFF;" version="1.1" viewBox="0 0 453 458" width="453px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="155.5938" style="stroke:#000000;stroke-width:1.5;" width="361.5" x="84.5" y="173.3125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="22" x2="22" y1="82.6094" y2="376.2578"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="142.5" x2="142.5" y1="82.6094" y2="376.2578"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="314" x2="314" y1="82.6094" y2="376.2578"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="401" x2="401" y1="82.6094" y2="376.2578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="5" y="79.5332">User</text><ellipse cx="22.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22.5,21.5 L22.5,48.5 M9.5,29.5 L35.5,29.5 M22.5,48.5 L9.5,63.5 M22.5,48.5 L35.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="5" y="389.791">User</text><ellipse cx="22.5" cy="401.3672" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22.5,409.3672 L22.5,436.3672 M9.5,417.3672 L35.5,417.3672 M22.5,436.3672 L9.5,451.3672 M22.5,436.3672 L35.5,451.3672 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="94.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="101.5" y="71.5332">HTTP Server</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="94.5" y="375.2578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="101.5" y="396.791">HTTP Server</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83" x="273" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="280" y="71.5332">RPC Client</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83" x="273" y="375.2578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="280" y="396.791">RPC Client</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="366" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="373" y="71.5332">KV Store</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="366" y="375.2578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="373" y="396.791">KV Store</text><polygon fill="#181818" points="130.5,110.9609,140.5,114.9609,130.5,118.9609,134.5,114.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="22.5" x2="136.5" y1="114.9609" y2="114.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="29.5" y="110.1045">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="40.5" y="110.1045">send operation</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="142.5" x2="184.5" y1="145.3125" y2="145.3125"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="184.5" x2="184.5" y1="145.3125" y2="158.3125"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="143.5" x2="184.5" y1="158.3125" y2="158.3125"/><polygon fill="#181818" points="153.5,154.3125,143.5,158.3125,153.5,162.3125,149.5,158.3125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="149.5" y="140.4561">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="160.5" y="140.4561">hash key</text><path d="M84.5,173.3125 L145.5,173.3125 L145.5,181.6641 L135.5,191.6641 L84.5,191.6641 L84.5,173.3125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.5938" style="stroke:#000000;stroke-width:1.5;" width="361.5" x="84.5" y="173.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="99.5" y="187.8076">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="122" x="160.5" y="186.7314">[hash(key) == local_id]</text><polygon fill="#181818" points="389,210.0156,399,214.0156,389,218.0156,393,214.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="142.5" x2="395" y1="214.0156" y2="214.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="149.5" y="209.1592">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="160.5" y="209.1592">do operation</text><polygon fill="#181818" points="153.5,240.3672,143.5,244.3672,153.5,248.3672,149.5,244.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="147.5" x2="400" y1="244.3672" y2="244.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="159.5" y="239.5107">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="170.5" y="239.5107">return result</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="84.5" x2="446" y1="253.3672" y2="253.3672"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="119" x="89.5" y="264.7861">[hash(key) != local_id]</text><polygon fill="#181818" points="302.5,286.5547,312.5,290.5547,302.5,294.5547,306.5,290.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="142.5" x2="308.5" y1="290.5547" y2="290.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="149.5" y="285.6982">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="160.5" y="285.6982">send operation to target</text><polygon fill="#181818" points="153.5,316.9063,143.5,320.9063,153.5,324.9063,149.5,320.9063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="147.5" x2="313.5" y1="320.9063" y2="320.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="159.5" y="316.0498">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="170.5" y="316.0498">return result</text><polygon fill="#181818" points="33.5,354.2578,23.5,358.2578,33.5,362.2578,29.5,358.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="27.5" x2="141.5" y1="358.2578" y2="358.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="39.5" y="353.4014">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="50.5" y="353.4014">return result</text><!--MD5=[271ed6292998559e30cec20debbf7e03]
@startuml 接收http流程

actor User as user
participant "HTTP Server" as hs
participant "RPC Client" as rc
participant "KV Store" as kv

autonumber
user - -> hs: send operation
hs - -> hs: hash key

alt hash(key) == local_id
    hs - -> kv: do operation
    kv - -> hs: return result
else hash(key) != local_id
    hs - -> rc: send operation to target
    rc - -> hs: return result
end
hs - -> user: return result

@enduml

PlantUML version 1.2022.7(Tue Aug 23 01:01:30 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>